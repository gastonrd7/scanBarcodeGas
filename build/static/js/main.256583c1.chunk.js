(this["webpackJsonpscanner-app"]=this["webpackJsonpscanner-app"]||[]).push([[0],{14:function(e,t,i){},15:function(e,t,i){},16:function(e,t,i){},17:function(e,t,i){"use strict";i.r(t);var s=i(0),a=i(1),n=i.n(a),r=i(8),o=i.n(r),h=(i(14),i(2)),d=i(3),c=i(6),u=i(5),l=i(4);i(15);var p=function(e){Object(c.a)(i,e);var t=Object(u.a)(i);function i(){var e;return Object(h.a)(this,i),(e=t.call(this)).state={hasUserMedia:!1,result:null},e.scanBarcode=e.scanBarcode.bind(Object(l.a)(e)),e}return Object(d.a)(i,[{key:"componentDidMount",value:function(){(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)&&(i.mountedInstances.push(this),this.state.hasUserMedia||i.userMediaRequested||this.requestUserMedia(),this.scanBarcode())}},{key:"componentWillUpdate",value:function(e){JSON.stringify(e.audioConstraints)===JSON.stringify(this.props.audioConstraints)&&JSON.stringify(e.videoConstraints)===JSON.stringify(this.props.videoConstraints)||this.requestUserMedia()}},{key:"componentWillUnmount",value:function(){var e=i.mountedInstances.indexOf(this);i.mountedInstances.splice(e,1),i.userMediaRequested=!1,0===i.mountedInstances.length&&this.state.hasUserMedia&&(this.stream.getVideoTracks&&this.stream.getAudioTracks?(this.stream.getVideoTracks().map((function(e){return e.stop()})),this.stream.getAudioTracks().map((function(e){return e.stop()}))):this.stream.stop(),window.URL.revokeObjectURL(this.state.src))}},{key:"getScreenshot",value:function(){if(!this.state.hasUserMedia)return null;var e=this.getCanvas();return e&&e.toDataURL(this.props.screenshotFormat,this.props.screenshotQuality)}},{key:"getCanvas",value:function(){if(!this.state.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var e=document.createElement("canvas"),t=this.video.videoWidth/this.video.videoHeight,i=this.props.minScreenshotWidth||this.video.clientWidth,s=i/t;this.props.minScreenshotHeight&&s<this.props.minScreenshotHeight&&(i=(s=this.props.minScreenshotHeight)*t),e.width=i,e.height=s,this.canvas=e,this.ctx=e.getContext("2d")}var a=this.ctx,n=this.canvas;return a.imageSmoothingEnabled=this.props.imageSmoothing,a.drawImage(this.video,0,0,n.width,n.height),n}},{key:"clearOverlay",value:function(){var e=document.getElementById("overlay").getContext("2d");return e.clearRect(0,0,this.props.width,this.props.height),e.strokeStyle="#ff0000",e.lineWidth=5,e}},{key:"scanBarcode",value:function(){var e=this;if(window.reader){var t=document.createElement("canvas");t.width=this.props.width,t.height=this.props.height;var i=t.getContext("2d");i.drawImage(this.video,0,0,this.props.width,this.props.height),window.reader.decodeBuffer(i.getImageData(0,0,t.width,t.height).data,t.width,t.height,4*t.width,window.dynamsoft.BarcodeReader.EnumImagePixelFormat.IPF_ARGB_8888).then((function(t){e.showResults(t)}))}}},{key:"showResults",value:function(e){this.clearOverlay();var t=[];try{for(var i=0;i<e.length;++i)e[i].LocalizationResult.ExtendedResultArray[0].Confidence>=30&&(t.push(e[i].BarcodeText),e[i].LocalizationResult,this.setState({result:e[i].BarcodeText}));t.length>0?this.props.onScann(t.join(", ")):this.scanBarcode(),this.scanBarcode()}catch(s){this.scanBarcode()}}},{key:"requestUserMedia",value:function(){var e=this;navigator.getUserMedia=navigator.mediaDevices.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var t=function(t,s){var a={video:s||!0};e.props.audio&&(a.audio=t||!0),navigator.mediaDevices.getUserMedia(a).then((function(e){i.mountedInstances.forEach((function(t){return t.handleUserMedia(null,e)}))})).catch((function(e){i.mountedInstances.forEach((function(t){return t.handleUserMedia(e)}))}))};if("mediaDevices"in navigator)t(this.props.audioConstraints,this.props.videoConstraints);else{var s=function(e){return{optional:[{sourceId:e}]}},a=function(e){var t=(e||{}).deviceId;return"string"===typeof t?t:Array.isArray(t)&&t.length>0?t[0]:"object"===typeof t&&t.ideal?t.ideal:null};MediaStreamTrack.getSources((function(i){var n=null,r=null;i.forEach((function(e){"audio"===e.kind?n=e.id:"video"===e.kind&&(r=e.id)}));var o=a(e.props.audioConstraints);o&&(n=o);var h=a(e.props.videoConstraints);h&&(r=h),t(s(n),s(r))}))}i.userMediaRequested=!0}},{key:"handleUserMedia",value:function(e,t){if(e)return this.setState({hasUserMedia:!1}),void this.props.onUserMediaError(e);this.stream=t;try{this.video.srcObject=t,this.setState({hasUserMedia:!0})}catch(i){this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}this.props.onUserMedia()}},{key:"render",value:function(){var e=this;return Object(s.jsxs)("div",{id:"videoview",width:this.props.width,height:this.props.height,children:[Object(s.jsx)("button",{onClick:this.scanBarcode,children:"Scan Barcodes"}),Object(s.jsx)("video",{autoPlay:!0,width:this.props.width,height:this.props.height,src:this.state.src,muted:this.props.audio,className:this.props.className,playsInline:!0,style:this.props.style,ref:function(t){e.video=t}}),Object(s.jsx)("canvas",{id:"overlay",width:this.props.width,height:this.props.height})]})}}]),i}(a.Component);p.defaultProps={audio:!0,className:"",height:480,imageSmoothing:!0,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",width:640,screenshotQuality:.92,videoConstraints:{facingMode:/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?{exact:"environment"}:"user"}},p.mountedInstances=[],p.userMediaRequested=!1;i(16);var v=function(e){Object(c.a)(i,e);var t=Object(u.a)(i);function i(){var e;return Object(h.a)(this,i),(e=t.call(this)).setResult=function(t){e.setState({result:t})},e.state={result:null},e}return Object(d.a)(i,[{key:"render",value:function(){return Object(s.jsxs)("div",{className:"App",children:[Object(s.jsx)(p,{onScann:this.setResult}),Object(s.jsx)("p",{children:this.state.result})]})}}]),i}(a.Component),g=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,18)).then((function(t){var i=t.getCLS,s=t.getFID,a=t.getFCP,n=t.getLCP,r=t.getTTFB;i(e),s(e),a(e),n(e),r(e)}))};o.a.render(Object(s.jsx)(n.a.StrictMode,{children:Object(s.jsx)(v,{})}),document.getElementById("root")),g()}},[[17,1,2]]]);
//# sourceMappingURL=main.256583c1.chunk.js.map